---
title:[Oracle]--ADG备库无备用电源导致数据库丢失修复
date:2020-08-29
---



​		下班之后，接到客户反应数据库备库服务器不正常现象，由于护网行动期间无法远程连接查看情况，所以只能去客户现场。经排查后，发现由于备库没有UPS备用电源，加之前些天机房停电引发的，服务器在来电后非法重启导致文件系统只读。



### 发现问题

刚上系统客户端，发现系统的ssh远程连接是无法使用的。
报错Read-only file system

下面是当时的留念照，关键企业信息已处理。
![机房_dg.jpg](http://cdn.lifemini.cn/dbblog/20200903/e639eada8ed341379c14a91cdbc67a0a.jpg)

于是匆忙进入u01目录下发现该目录下为空，也就意味着**数据库没了**。
----------------------------------吓我一跳😨----------------------------



### 解决问题

不敢断然重启服务器，经过不断的搜索，
使用mount -o remount rw / 命令，
重新挂载根目录顺利将sshd服务启动。

![解决方法.jpg](http://cdn.lifemini.cn/dbblog/20200829/93d14a401b78451880708a7779e1eafb.png)

但服务器中数据库软件丢失的问题仍然存在，
与往期巡检报告对比发现磁盘容量也存在问题，
协商后决定重启服务器，重启后数据库软件及文件均恢复。

由于备库采用ADG，且主备之间归档相差太大，
选择基于时间点的增量恢复，将ADG恢复。



### 事故总结

与客户沟通后，查明机房前些天停过电；
主库服务器有电源，但是备库没有电源；
停电时，备库服务器非法关闭导致linux文件系统只读。

<span style='color:blue'>**建议：**将主备库均添加备用电源。</span>